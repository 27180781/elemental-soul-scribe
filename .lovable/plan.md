

# תכנית: הוספת אופציה להתפלגות רחבה של סוגי אישיות

## הבעיה הנוכחית
האלגוריתם מחשב את המרחק האוקלידי בין הציונים של המשתתף לכל סוג אישיות ובוחר את הקרוב ביותר. כתוצאה מכך, כאשר יש משתתפים רבים עם תוצאות דומות, רובם מקבלים את אותו סוג אישיות.

## הפתרון המוצע

### זיהוי ריכוזיות גבוהה
- לאחר חישוב הפרופילים, המערכת תבדוק כמה אחוז מהמשתתפים קיבלו כל סוג אישיות
- אם יש סוג אישיות עם יותר מ-10% מהמשתתפים, תוצג התראה עם אפשרות להפעיל "התפלגות רחבה"

### אלגוריתם התפלגות רחבה
במצב זה, במקום לבחור רק את הסוג הקרוב ביותר, המערכת תפעל כך:
1. תחשב את 3 סוגי האישיות הקרובים ביותר לכל משתתף
2. תפזר את המשתתפים בין האפשרויות הקרובות כדי ליצור התפלגות יותר אחידה
3. תתן עדיפות לשמירה על דיוק (לא לשייך לסוג רחוק מדי) תוך שיפור הגיוון

## שינויים טכניים

### 1. עדכון DataContext.tsx
- הוספת משתנה `distributionMode: 'normal' | 'wide'`
- הוספת פונקציה `setDistributionMode` להחלפה בין המצבים
- עדכון פונקציית `calculateProfiles` לתמוך בשני מצבי חישוב

```text
+----------------------------------+
|     calculateProfiles()          |
+----------------------------------+
           |
           v
+----------------------------------+
|   חישוב ציוני אלמנטים רגיל      |
+----------------------------------+
           |
           v
+----------------------------------+
|   distributionMode === 'wide'?   |
+----------------------------------+
        /          \
      כן            לא
       |             |
       v             v
+------------------+ +------------------+
| אלגוריתם פיזור  | | מציאת התאמה     |
| רחב - 3 אפשרויות| | קרובה ביותר     |
| + איזון כמויות  | +------------------+
+------------------+
```

### 2. עדכון Results.tsx
- הוספת חישוב סטטיסטיקות התפלגות
- הצגת התראה כאשר יש ריכוזיות גבוהה (>10%)
- כפתור מעבר בין "התפלגות רגילה" ל"התפלגות רחבה"
- הצגת סטטיסטיקת התפלגות נוכחית

### 3. עדכון types/personality.ts
- הוספת טיפוס `DistributionMode`

## ממשק משתמש

בדף התוצאות יופיע:
- **תיבת התראה** (כאשר יש ריכוזיות >10%): "שים לב! X% מהמשתתפים קיבלו את אותו סוג אישיות"
- **כפתור החלפה**: "עבור להתפלגות רחבה" / "חזור להתפלגות רגילה"
- **תצוגת סטטיסטיקות**: טבלה קטנה המציגה כמה משתתפים בכל סוג אישיות

## יתרונות הפתרון
1. **שמירה על דיוק** - משתתף עדיין מקבל סוג אישיות קרוב לתוצאות שלו
2. **גמישות** - המשתמש בוחר מתי להפעיל התפלגות רחבה
3. **שקיפות** - ניתן לראות את ההתפלגות לפני ואחרי השינוי
4. **הפיכות** - ניתן לחזור בקלות למצב הרגיל

